<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>린미 - 세상에 없던 H-커머스</title>
    <th:block th:replace="~{/fragments/header}" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.13.1/dist/sweetalert2.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" th:href="@{/assets/css/common.css}" />
    <link rel="stylesheet" th:href="@{/assets/css/header.css}" />
    <link rel="stylesheet" th:href="@{/assets/css/main.css}" />
    <link rel="stylesheet" th:href="@{/assets/css/footer.css}" />
    <link rel="stylesheet" th:href="@{/assets/css/view.css}" />
    <style>
      .footerContainer {
        margin-top: 100px !important;
      }
    </style>
  </head>
  <body>
    <div id="loading"></div>

    <!-- 오른쪽 하단 토글버튼 -->
    <div class="Topbutton">
      <a th:href="@{#}">
        <img th:src="@{/assets/img/main/topToggle.png}" />
      </a>
    </div>

    <!--****************************************************-->
    <!-- 메인 상세페이지 영역 -->
    <!--*****************************************************-->
    <main>
      <div class="view-top">
        <div style="--swiper-navigation-color: #fff; --swiper-pagination-color: #fff" class="swiper mySwiper2">
          <!-- 메인이미지 -->
          <div class="swiper-wrapper">
            <div class="swiper-slide main-img">
              <img th:src="${product.img}" />
            </div>
          </div>

          <!-- 미리보기 이미지 -->
          <div thumbsSlider="" class="swiper mySwiper">
            <div class="swiper-wrapper side-contents">
              <div class="swiper-slide side-img">
                <img th:src="${product.img}" />
              </div>
            </div>
          </div>
        </div>

        <!-- 상품정보영역 -->
        <div class="product-contents">
          <div class="product-container">
            <ul>
              <li class="productInfoItem brandName" th:text="${product.brandName}">브랜드 이름</li>
              <li class="productInfoItem productName" th:text="${product.productName}">상품 이름</li>
              <li>
                <i class="fa-regular fa-star" style="color: #ffd43b"></i>
                <i class="fa-regular fa-star" style="color: #ffd43b"></i>
                <i class="fa-regular fa-star" style="color: #ffd43b"></i>
                <i class="fa-regular fa-star" style="color: #ffd43b"></i>
                <i class="fa-regular fa-star" style="color: #ffd43b"></i>
                <span class="span-out">0 <span class="span-in">/ 5</span> <span class="span-in">후기</span> 0</span>
                <a th:href="@{#review}"><img class="arrow" th:src="@{/assets/img/view/arrow_showMore.png}" /></a>
              </li>
              <li class="discountRate">
                <span th:text="${product.discountRate + '%'}">할인율</span>
                <span class="originalPrice" th:text="${#numbers.formatInteger(product.price, 3, 'COMMA') + '원'}">원래 가격</span>
              </li>
              <li class="salePrice" th:text="${#numbers.formatInteger(product.salePrice, 3, 'COMMA') + '원'}">할인 가격</li>
              <li class="shippingInfo">배송정보</li>
              <li class="shippingInfo shipping">무료배송 <span>|</span> CJ대한통운</li>
            </ul>

            <!-- 필수표기정보 alert 창 -->
            <button class="required-Info">필수 표기 정보</button>
            <div class="required-box" style="display: none">
              <table>
                <tr>
                  <td>상품명</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>제조업소</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>제조업소</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>소재지</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>소비기한</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>보관방법</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>포장단위별 내용물의 용량(중량), 수량</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>포장단위별 수량</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>원료명 및 함량</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>영양정보</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>기능정보</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>섭취량,섭취방법 및 섭취시 주의사항</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>질병의 예방 및 치료를 위한 의약품이 아니라는 내용의 문구</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>유전자 변형 건강기능식품 해당하는 경우 표시</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>수입건강기능식품에 해당하는 경우</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>소비자 안전을 위한 주의사항</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
                <tr>
                  <td>소비자 상담 관련 전화번호</td>
                  <td>상품 상세페이지 참조</td>
                </tr>
              </table>
            </div>

            <div class="number-control">
              <button class="minus"></button>
              <span class="number">1</span>
              <button class="plus"></button>
            </div>

            <div class="total">
              <div class="total-text">상품금액 합계</div>
              <div
                class="total-price"
                data-unit-price="${product.salePrice}"
                th:attr="data-unit-price=${product.salePrice}"
                th:text="${#numbers.formatInteger(product.salePrice, 3, 'COMMA') + '원'}"></div>
            </div>

            <!-- **************************** -->
            <!-- 로그인 상태 -->
            <!-- **************************** -->
            <div class="btn" th:if="${session.memberInfo != null}">
              <form id="cartform" th:action="@{/api/cart/cart/add}" method="post">
                <input type="hidden" name="memberId" th:value="${session.memberInfo.memberId}" />
                <input type="hidden" name="productId" th:value="${product.productId}" />
                <!-- 수량▼ -->
                <input type="hidden" name="productCount" th:value="${product.productCount}" class="quantity-input" />
                <button type="submit" class="cart-btn">장바구니</button>
              </form>

              <form id="paymentform" th:action="@{/payment/payment_by_detail}" method="post">
                <input type="hidden" name="memberId" th:value="${session.memberInfo.memberId}" />
                <input type="hidden" name="productId" th:value="${product.productId}" />
                <!-- 수량▼ -->
                <input type="hidden" name="productCount" th:value="${product.productCount}" class="quantity-input" />
                <button type="submit" class="buy-btn">바로구매</button>
              </form>
            </div>

            <!-- **************************** -->
            <!-- 로그아웃 상태 -->
            <!-- **************************** -->
            <div class="btn" th:unless="${session.memberInfo != null}">
              <form id="cartform-not-log" th:action="@{/login}">
                <input type="hidden" name="memberId" />
                <input type="hidden" name="productId" />
                <!-- 수량▼ -->
                <input type="hidden" name="productCount" class="quantity-input" />
                <button type="submit" class="cart-btn">장바구니</button>
              </form>

              <form id="paymentform-not-log" th:action="@{/login}">
                <input type="hidden" name="productId" />
                <input type="hidden" name="quantity" value="1" class="quantity-input" />
                <button type="submit" class="buy-btn">바로구매</button>
              </form>
            </div>
          </div>
        </div>
      </div>

      <div class="endsolid solid"></div>

      <!-- **************************** -->
      <!-- 상품설명/리뷰/상품문의 -->
      <!-- **************************** -->
      <div class="sticky">
        <div class="productDetailTab">
          <ul class="imgtext">
            <li>
              <a th:href="@{#mainimg}" class="tab-link on">상품설명</a>
            </li>
            <li>
              <a th:href="@{#review}" class="tab-link">리뷰</a>
            </li>
            <li>
              <a th:href="@{#inquiry}" class="tab-link">상품문의</a>
            </li>
          </ul>
        </div>
      </div>

      <!--메인 제품 설명 이미지 -->
      <div id="mainimg">
        <img th:src="${product.dImg}" width="897" height="auto" />
      </div>

      <!-- 리뷰문의 -->
      <div id="review" class="review">
        <div class="division"></div>
        <div class="productReview">
          <div class="title">리뷰<span class="reviewCount">0</span></div>
          <div class="reviewInfo">
            <div class="scoreStatus"><span class="nowScore">0</span>/<span class="perfectScore">5</span></div>
            <div class="starScoreCover">
              <ul class="starScore">
                <i class="fa-regular fa-star" style="color: #ffd43b"></i>
                <i class="fa-regular fa-star" style="color: #ffd43b"></i>
                <i class="fa-regular fa-star" style="color: #ffd43b"></i>
                <i class="fa-regular fa-star" style="color: #ffd43b"></i>
                <i class="fa-regular fa-star" style="color: #ffd43b"></i>
              </ul>
            </div>
          </div>

          <ul class="reviewList">
            <li class="noData"></li>
          </ul>
        </div>
      </div>

      <!-- 상품문의 -->
      <div id="inquiry" class="review">
        <div class="division"></div>
        <div class="productInquiry">
          <div class="flex">
            <div class="title">상품 문의<span class="inquiryCount">0</span></div>
            <!-- 문의하기 버튼 -->
            <div class="button inquiry productInquiry" id="inquiry-alert">문의하기</div>
          </div>
          <!-- 문의 리스트 -->
          <ul class="inquiryList">
            <li class="inquiry">
              <div class="inquiryCover">
                <div class="inquiryTitle">제목</div>
                <div class="inquiryWriter">작성자</div>
                <div class="inquiryWriteDate">작성일</div>
                <div class="inquiryStatus">답변상태</div>
              </div>
            </li>
            <li class="noData"></li>
          </ul>
        </div>
      </div>

      <div class="division"></div>
    </main>
    <footer>
      <th:block th:replace="~{/fragments/footer}" />
    </footer>

    <!-- 스크립트 영역 -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://kit.fontawesome.com/2c827c8cca.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.13.1/dist/sweetalert2.all.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script th:src="@{/assets/js/header.js}"></script>
    <script th:src="@{/assets/js/view.js}"></script>
    <script>
      /*****************************************************/
      /* 추천순 / 혜택순 / 낮은가격순 / 높은가격순 글자 컬러 변경 
      /*****************************************************/
      const productText = document.querySelectorAll(".productText a");

      // 기본 컬러 설정 (추천순 글자컬러)
      const defaultLink = document.querySelector(".sort-recommend");
      defaultLink.classList.add("active");

      // 클릭 이벤트 추가
      productText.forEach((link) => {
        link.addEventListener("click", function (event) {
          event.preventDefault();

          // 모든 링크에서 activate 클래스 제거하고 기본값 설정
          productText.forEach((link) => {
            link.classList.remove("active");
            link.classList.add("sort-button"); // 기본값
          });

          // 클릭된 링크에 activate 클래스 추가
          this.classList.add("active");
          this.classList.remove("sort-button");
        });
      });
    </script>
    <script th:inline="javascript">
      const isLoggedIn = /*[[${session.memberInfo != null}]]*/ false;
      const addCartApiUrl = /*[[@{/api/cart/cart/add}]]*/ ""; // 장바구니 백엔드
      const cartUrl = /*[[@{/cart/cart}]]*/ ""; // 장바구니 페이지
      //const paymentApiUrl = /*[[@{/api/payment/payment}]]*/ ""; // 바로구매 백엔드
      //const paymentUrl = /*[[@{/payment/payment}]]*/ ""; //바로구매 페이지
    </script>
  </body>
</html>
